

<div id='map'></div>

<style>
#map {
  height: 600px;
  width: 100%;
}
</style>

<script>
  let map

    function initMap(){
      geocoder = new google.maps.Geocoder()

      map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 35.68123620000001, lng:139.7671248},
          zoom: 12,
      });


      <% @maps.each do |m| %>
          (function(){
          var latlng = new google.maps.LatLng(<%= m.latitude %>,<%= m.longitude %>);
          var contentString = "住所：<%= m.address %>";

          var marker = new google.maps.Marker({
              position:{lat: <%= m.latitude %>, lng: <%= m.longitude %>},
              map: map,
              title: contentString
          });

          var infowindow = new google.maps.InfoWindow({
            position: latlng,
            content: "<a href='<%= m.post.present? ? post_url(m.post.id): "" %>', target='_blank', 'data-turbolinks'= false><%= m.address %></a>"
          }); //ここで詳細ページへのリンクを表示させる
          marker.addListener('click', function() {
            infowindow.open(map, marker);
          });

          })();
      <% end %>
      }
</script>
<script
  src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAP_KEY'] %>&callback=initMap"
  async defer>
</script>